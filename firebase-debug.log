[debug] [2023-04-26T08:29:25.024Z] ----------------------------------------------------------------------
[debug] [2023-04-26T08:29:25.025Z] Command:       /Users/tautvydastijunaitis/.nvm/versions/node/v14.21.3/bin/node /Users/tautvydastijunaitis/.nvm/versions/node/v14.21.3/bin/firebase ext:dev:publish mailersend/mailersend-email --repo=https://github.com/mailersend/mailersend-firebase --ref=2af4126
[debug] [2023-04-26T08:29:25.025Z] CLI Version:   11.29.0
[debug] [2023-04-26T08:29:25.026Z] Platform:      darwin
[debug] [2023-04-26T08:29:25.026Z] Node Version:  v14.21.3
[debug] [2023-04-26T08:29:25.026Z] Time:          Wed Apr 26 2023 11:29:25 GMT+0300 (Eastern European Summer Time)
[debug] [2023-04-26T08:29:25.026Z] ----------------------------------------------------------------------
[debug] 
[debug] [2023-04-26T08:29:25.029Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2023-04-26T08:29:25.029Z] > authorizing via signed-in user (tautvydas@mailerlite.com)
[debug] [2023-04-26T08:29:25.030Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email [none]
[debug] [2023-04-26T08:29:26.400Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email 200
[debug] [2023-04-26T08:29:26.400Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email {"name":"publishers/mailersend/extensions/mailersend-email","ref":"mailersend/mailersend-email","latestVersion":"0.1.4","latestVersionCreateTime":"2023-04-26T08:27:30.954052Z","state":"PUBLISHED","createTime":"2023-04-05T13:49:44.376201Z","visibility":"UNLISTED","registryLaunchStage":"EXPERIMENTAL","publisher":{"displayName":"MailerSend","iconUri":"https://storage.googleapis.com/firebase-extensions-icons/publisher_icons/mailersend/mailersend.png"}}
[debug] [2023-04-26T08:29:26.401Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email/versions/0.1.4 [none]
[debug] [2023-04-26T08:29:27.450Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email/versions/0.1.4 200
[debug] [2023-04-26T08:29:27.450Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/publishers/mailersend/extensions/mailersend-email/versions/0.1.4 {"name":"publishers/mailersend/extensions/mailersend-email/versions/0.1.4","ref":"mailersend/mailersend-email@0.1.4","spec":{"specVersion":"v1beta","name":"mailersend-email","version":"0.1.4","description":"Send transactional emails using MailerSend.","roles":[{"role":"datastore.user","reason":"Required to update emails in collection that have failed to send"}],"resources":[{"name":"processDocumentCreated","type":"firebaseextensions.v1beta.function","propertiesYaml":"eventTrigger:\n  eventType: providers/cloud.firestore/eventTypes/document.create\n  resource: projects/${PROJECT_ID}/databases/(default)/documents/${EMAIL_COLLECTION}/{documentId}\nlocation: ${LOCATION}\nruntime: nodejs16\n","description":"Processes created document in Cloud Firestore collection, sends an email and updates status information.","deletionPolicy":"DELETE"}],"billingRequired":true,"author":{"authorName":"MailerSend","url":"https://www.mailersend.com"},"contributors":[{"authorName":"Ramunas Pabreza","email":"ramunas@mailerlite.com"},{"authorName":"Tautvydas Tijunaitis","email":"tautvydas@mailerlite.com"}],"license":"Apache-2.0","releaseNotesUrl":"https://github.com/mailersend/mailersend-firebase/CHANGELOG.md","sourceUrl":"https://github.com/mailersend/mailersend-firebase","params":[{"param":"LOCATION","label":"Cloud Functions location","type":"SELECT","description":"Where do you want to deploy the functions created for this extension? For help selecting a location, refer to the [location selection guide](https://firebase.google.com/docs/functions/locations).","required":true,"options":[{"value":"us-central1","label":"Iowa (us-central1)"},{"value":"us-east1","label":"South Carolina (us-east1)"},{"value":"us-east4","label":"Northern Virginia (us-east4)"},{"value":"us-west2","label":"Los Angeles (us-west2)"},{"value":"us-west3","label":"Salt Lake City (us-west3)"},{"value":"us-west4","label":"Las Vegas (us-west4)"},{"value":"europe-central2","label":"Warsaw (europe-central2)"},{"value":"europe-west1","label":"Belgium (europe-west1)"},{"value":"europe-west2","label":"London (europe-west2)"},{"value":"europe-west3","label":"Frankfurt (europe-west3)"},{"value":"europe-west6","label":"Zurich (europe-west6)"},{"value":"asia-east2","label":"Hong Kong (asia-east2)"},{"value":"asia-northeast1","label":"Tokyo (asia-northeast1)"},{"value":"asia-northeast2","label":"Osaka (asia-northeast2)"},{"value":"asia-northeast3","label":"Seoul (asia-northeast3)"},{"value":"asia-south1","label":"Mumbai (asia-south1)"},{"value":"asia-southeast2","label":"Jakarta (asia-southeast2)"},{"value":"northamerica-northeast1","label":"Montreal (northamerica-northeast1)"},{"value":"southamerica-east1","label":"Sao Paulo (southamerica-east1)"},{"value":"australia-southeast1","label":"Sydney (australia-southeast1)"}],"immutable":true},{"param":"EMAIL_COLLECTION","label":"Emails documents collection","type":"STRING","description":"What is the path to the collection that contains the documents used to build and send the email?","required":true,"default":"emails","validationRegex":"^[^/]+(/[^/]+/[^/]+)*$","validationErrorMessage":"Must be a valid Cloud Firestore collection."},{"param":"MAILERSEND_API_KEY","label":"MailerSend API key","type":"SECRET","description":"API tokens are used for authentication when sending emails. You can find more details how to create MailerSend API token [here](https://www.mailersend.com/help/managing-api-tokens).","required":true,"example":"eyJ*******************************"},{"param":"DEFAULT_FROM_EMAIL","label":"Default FROM email address","type":"STRING","description":"The email address to use as the sender's address (if it's not specified in the added email document or template).","example":"email@example.com","validationRegex":"^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9-.]+.[a-zA-Z0-9-]+$","validationErrorMessage":"Must be a valid email address or valid name plus email address"},{"param":"DEFAULT_FROM_NAME","label":"Default FROM name","type":"STRING","description":"The name to use as the sender's name.","example":"John doe"},{"param":"DEFAULT_REPLY_TO_EMAIL","label":"Default reply to email address","type":"STRING","description":"The email address to use as the reply to address (if it's not specified in the added email document or template).","example":"email@example.com","validationRegex":"^[a-zA-Z0-9.!#$%&'*+\\/=?^_`{|}~-]+@[a-zA-Z0-9-.]+.[a-zA-Z0-9-]+$","validationErrorMessage":"Must be a valid email address or valid name plus email address"},{"param":"DEFAULT_REPLY_TO_NAME","label":"Default reply to name","type":"STRING","description":"The name to use as the reply to name.","example":"John doe"},{"param":"DEFAULT_TEMPLATE_ID","label":"Default template ID","type":"STRING","description":"The default template id to use for emails (it will be used if not specified in the added email document).","example":"o65qngk2vn3gwr12"}],"preinstallContent":"# Send emails with MailerSend\n\n**Author**: [MailerSend](https://www.mailersend.com)\n\n**Description**: MailerSend is a transactional messaging service that enables developers to work faster and smarter.\n\nAn intuitively designed interface enables anyone to contribute to transactional email and SMS, while advanced sending infrastructure and flexible payment plans let you scale your sendings.\n\nBuilt by deliverability experts, your messages always get delivered, along with dedicated IP, email verification and inbound routing for a comprehensive solution.\n\nGet started for free!\n\n**Details**: Use this extension to send emails that contain the information from documents added to a specified Cloud Firestore collection. Adding a document triggers this extension to send an email built from the document's fields.\n\nNote that MailerSend allows you to:\n- schedule emails\n- send bulk emails\n- add attachments up to 25MB\n- organize your sendings with tags\n- track opens, clicks, and spam reports.\n\nWe welcome [bug reports and feature requests](https://github.com/mailersend/mailersend-firebase/issues/new) as well as pull requests in this GitHub repository.\n\n##### Table of Contents  \n\n  * [🧩 Install this extension](#-install-this-extension)\n    + [Console](#console)\n    + [Firebase CLI](#firebase-cli)\n  * [💪 Use the extension](#-use-the-extension)\n    + [Send an email](#send-an-email)\n    + [Additional setup](#additional-setup)\n    + [Collection fields](#collection-fields)\n    + [Email results](#email-results)\n  * [💳 Billing](#-billing)\n  * [⚙️ Configuration](#-configuration)\n    + [Configuration parameters](#configuration-parameters)\n    + [Cloud Functions](#cloud-functions)\n---\n\n## 🧩 Install this extension\n\n### Console\n\n[![Install this extension in your Firebase project](https://www.gstatic.com/mobilesdk/210513_mobilesdk/install-extension.png \"Install this extension in your Firebase project\")][install-link]\n\n[install-link]: https://console.firebase.google.com/project/_/extensions/install?ref=mailersend/mailersend-email\n\n### Firebase CLI\n\n```bash\nfirebase ext:install mailersend/mailersend-email --project=[your-project-id]\n```\n\n> Learn more about installing extensions in the Firebase Extensions documentation:\n> [console](https://firebase.google.com/docs/extensions/install-extensions?platform=console),\n> [CLI](https://firebase.google.com/docs/extensions/install-extensions?platform=cli)\n\n\n## 💪 Use the extension\n\nAfter its installation, this extension monitors all document writes to the `EMAIL_COLLECTION` collection. Email is sent based on the contents of the document's fields. The document's fields specify an email data.\n\n### Send an email\n<details>\n<summary>Here's a basic example document write that would trigger this extension</summary>\n\n```js\nadmin.firestore().collection('emails').add({\n  to: [\n    {\n      email: 'recipient@example.com',\n      name: 'Recipient name'\n    }\n  ],\n  from: {\n    email: 'from@example.com',\n    name: 'From name'\n  },\n  cc: [\n    {\n      email: 'cc.recipient@example.com',\n      name: 'CC recipient name'\n    }\n  ],\n  bcc: [\n    {\n      email: 'bcc.recipient@example.com',\n      name: 'Bcc recipient name'\n    }\n  ],\n  subject: 'Hello from Firebase!',\n  html: 'This is an <code>HTML</code> email body.',\n  text: 'This is an TEXT email body.',\n  template_id: 'abc123ced',\n    variables: [\n      {\n        email: 'recipient@example.com',\n        substitutions: [\n          {\n            var: 'variable_name',\n            value: 'variable value'\n          }\n        ]\n      }\n    ],\n    personalization: [\n      {\n        email: 'recipient@example.com',\n        data: {\n          personalization_name: 'personalization value'\n        }\n      }\n    ],\n    tags: ['tag1', 'tag2'],\n    reply_to: {\n      email: 'reply_to@example.com',\n        name: 'Reply to name'\n    },\n    send_at: '123465789'\n})\n```\n\n</details>\n\n### Additional setup\n\nBefore installing this extension, set up the following Firebase service in your Firebase project:\n\n- [Cloud Firestore](https://firebase.google.com/docs/firestore/quickstart) collection in your Firebase project.\n\nThen, in the MailerSend dashboard:\n\n- Add a [domain](https://app.mailersend.com/domains) and verify it editing your DNS records.\n- Create a new [API token](https://app.mailersend.com/api-tokens) with full access.\n\n\n\n### Collection fields\n\n<details>\n<summary>Find all the JSON field parameters you can add to your API call, provided in dot notation </summary>\n\n\n| JSON field parameter                | Type       | Required | Limitations                                                       | Details                                                                                                                                                                                                       |\n|-------------------------------------|------------|----------|-------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `from`                              | `object`   | yes *    |                                                                   | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.email`                        | `string`   | yes *    | Must be a verified domain or subdomain. | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.name`                         | `string`   | no       |                                                                   | `from.email` will be used if not provided or, if set in extension config or `template_id` is present with default values, the default subject from that will be used.                                         |\n| `to`                                | `object[]` | yes      | Min `1`, max `50`                                                 |                                                                                                                                                                                                               |\n| `to.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `to.*.name`                         | `string`   | no       |                                                                   | The name of the recipient. May not contain `;` or `,`.                                                                                                                                                        |\n| `cc`                                | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `cc.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `cc.*.name`                         | `string`   | no       |                                                                   | The name of the CC recipient. May not contain `;` or `,`.                                                                                                                                                     |\n| `bcc`                               | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `bcc.*.email`                       | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `bcc.*.name`                        | `string`   | no       |                                                                   | The name of the BCC recipient. May not contain `;` or `,`.                                                                                                                                                    |\n| `reply_to`                          | `object`   | no       |                                                                   |                                                                                                                                                                                                               |\n| `reply_to.email`                    | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `reply_to.name`                     | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `subject`                           | `string`   | yes *    |                                                                   | Not required if `template_id` is present and template has default subject set.                                                                                                                                |\n| `text`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in a text (`text/plain`) format. * Only required if there's no `html` or `template_id` present.                                                                                             |\n| `html`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in HTML (`text/html`) format. * Only required if there's no `text` or `template_id` present.                                                                                                |\n| `template_id`                       | `string`   | yes *    |                                                                   | * Only required if there's no `text` or `html` present.                                                                                                                                                       |\n| `tags`                              | `string[]` | no       |                                                                   | Limit is max 5 tags.                                                                                                                                                                                          |\n| `variables`                         | `object[]` | no       |                                                                   | These will be replaced in the email content using `{$var}` format. Can be used in the `subject`, `html`, `text` fields.                                                                                       |\n| `variables.*.email`                 | `string`   | yes      |                                                                   | Email address that substitutions will be applied to. Read more about [simple personalization](features.html#simple-personalization).                                                                          |\n| `variables.*.substitutions`         | `object[]` | yes      |                                                                   |                                                                                                                                                                                                               |\n| `variables.*.substitutions.*.var`   | `string`   | yes      |                                                                   | Name of the variable, will replace `{$var}` in the `subject`, `html`, `text` fields.                                                                                                                          |\n| `variables.*.substitutions.*.value` | `string`   | yes      |                                                                   | Value to be replaced, based on the `variables.*.substitutions.*.var`  name.                                                                                                                                   |\n| `personalization`                   | `object[]` | no       |                                                                   | Allows using personalization in <code v-pre>{{ var }}</code> syntax. Can be used in the `subject`, `html`, `text` fields. Read more about [advanced personalization](features.html#advanced-personalization). |\n| `personalization.*.email`           | `string`   | yes      |                                                                   | Email address that personalization will be applied to.                                                                                                                                                        |\n| `personalization.*.data`            | `object[]` | yes      |                                                                   | Object with `key: value` pairs. Values will be added to your template using <code v-pre>{{ key }}</code> syntax.                                                                                              |\n| `send_at`                           | `integer`  | no       | min: `now`, max: `now + 72hours`                                  | Has to be a [Unix timestamp](https://www.unixtimestamp.com/). **Please note that this timestamp is a minimal guarantee and that the email could be delayed due to server load.**                             |\n\n</details>\n\n### Email results\n\nAfter email sending is triggered this extension fills results into the `delivery` field.\n\n| Field      | Description                                    |\n|------------|------------------------------------------------|\n| error      | Validation error, or error from the server     |\n| message_id | Message ID in MailerSend system                |\n| state      | State of an email sending: `ERROR`, `SUCCESS`  |\n\n\n<!-- We recommend keeping the following section to explain how billing for Firebase Extensions works -->\n## 💳 Billing\n\nThis extension uses other Firebase or Google Cloud Platform services which may have associated charges:\n\n<!-- List all products the extension interacts with -->\n- Cloud Functions\n\nWhen you use Firebase Extensions, you're only charged for the underlying resources that you use. A paid-tier billing plan is only required if the extension uses a service that requires a paid-tier plan, for example calling to a Google Cloud Platform API or making outbound network requests to non-Google services. All Firebase services offer a free tier of usage. [Learn more about Firebase billing.](https://firebase.google.com/pricing)\n\nThis extension also uses the following third-party services:\n\n- MailerSend ([pricing information](https://mailersend.com/pricing))\n\nYou are responsible for any costs associated with your use of these services.\n\n## ⚙️ Configuration\n\n### Configuration Parameters\n\n* Cloud Functions location: Where do you want to deploy the functions created for this extension? For help selecting a location, refer to the [location selection guide](https://firebase.google.com/docs/functions/locations).\n\n* Emails documents collection: What is the path to the collection that contains the documents used to build and send the email?\n\n* MailerSend API key: API tokens are used for authentication when sending emails. You can find more details how to create an API token [here](https://www.mailersend.com/help/managing-api-tokens).\n* Email parameters:\n\n    + Default FROM email address: The email address to use as the sender's address (if it's not specified in the added email document or template).\n\n    + Default FROM name: The name to use as the sender's name.\n\n    + Default reply to email address: The email address to use as the reply to address (if it's not specified in the added email document or template).(not required)\n\n    + Default reply to name: The name to use as the reply to name. (not required)\n\n    + Default template ID: The default template id to use for emails (it will be used if not specified in the added email document).\n\n\n\n### Cloud Functions\n\n* processDocumentCreated: Processes created document in Cloud Firestore collection, sends an email and updates status information.\n","postinstallContent":"<!-- \nThis file provides your users an overview of how to use your extension after they've installed it. All content is optional, but this is the recommended format. Your users will see the contents of this file in the Firebase console after they install the extension.\n\nInclude instructions for using the extension and any important functional details. Also include **detailed descriptions** for any additional post-installation setup required by the user.\n\nReference values for the extension instance using the ${param:PARAMETER_NAME} or ${function:VARIABLE_NAME} syntax.\nLearn more in the docs: https://firebase.google.com/docs/extensions/alpha/create-user-docs#reference-in-postinstall\n\nLearn more about writing a POSTINSTALL.md file in the docs:\nhttps://firebase.google.com/docs/extensions/alpha/create-user-docs#writing-postinstall\n-->\n##### Table of Contents  \n\n  * [💪 Use the extension](#-use-the-extension)\n    + [Send an email](#send-an-email)\n    + [Collection fields](#collection-fields)\n    + [Email results](#email-results)\n  * [👀 Monitoring](#-monitoring)\n\n---\n\n## 💪 Use the extension\n\nUse this extension to send emails that contain the information from documents added to a specified Cloud Firestore collection.\n\nAfter its installation, this extension monitors all document writes to the `EMAIL_COLLECTION` collection. Email is sent based on the contents of the document's fields. The document's fields specify an email data. Adding a document triggers this extension to send an email built from the document's fields.\n\n\n### Send an email\n<details>\n<summary>Here's a basic example document write that would trigger this extension</summary>\n\n```js\nadmin.firestore().collection('emails').add({\n  to: [\n    {\n      email: 'recipient@example.com',\n      name: 'Recipient name'\n    }\n  ],\n  from: {\n    email: 'from@example.com',\n    name: 'From name'\n  },\n  cc: [\n    {\n      email: 'cc.recipient@example.com',\n      name: 'CC recipient name'\n    }\n  ],\n  bcc: [\n    {\n      email: 'bcc.recipient@example.com',\n      name: 'Bcc recipient name'\n    }\n  ],\n  subject: 'Hello from Firebase!',\n  html: 'This is an <code>HTML</code> email body.',\n  text: 'This is an TEXT email body.',\n  template_id: 'abc123ced',\n    variables: [\n      {\n        email: 'recipient@example.com',\n        substitutions: [\n          {\n            var: 'variable_name',\n            value: 'variable value'\n          }\n        ]\n      }\n    ],\n    personalization: [\n      {\n        email: 'recipient@example.com',\n        data: {\n          personalization_name: 'personalization value'\n        }\n      }\n    ],\n    tags: ['tag1', 'tag2'],\n    reply_to: {\n      email: 'reply_to@example.com',\n        name: 'Reply to name'\n    },\n    send_at: '123465789'\n})\n```\n\n</details>\n\n\n### Collection fields\n\n<details>\n<summary>Find all the JSON field parameters you can add to your API call, provided in dot notation </summary>\n\n\n| JSON field parameter                | Type       | Required | Limitations                                                       | Details                                                                                                                                                                                                       |\n|-------------------------------------|------------|----------|-------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `from`                              | `object`   | yes *    |                                                                   | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.email`                        | `string`   | yes *    | Must be a verified domain or a subdomain from a verified domain . | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.name`                         | `string`   | no       |                                                                   | `from.email` will be used if not provided or, if set in extension config or `template_id` is present with default values, the default subject from that will be used.                                         |\n| `to`                                | `object[]` | yes      | Min `1`, max `50`                                                 |                                                                                                                                                                                                               |\n| `to.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `to.*.name`                         | `string`   | no       |                                                                   | The name of the recipient. May not contain `;` or `,`.                                                                                                                                                        |\n| `cc`                                | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `cc.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `cc.*.name`                         | `string`   | no       |                                                                   | The name of the CC recipient. May not contain `;` or `,`.                                                                                                                                                     |\n| `bcc`                               | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `bcc.*.email`                       | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `bcc.*.name`                        | `string`   | no       |                                                                   | The name of the BCC recipient. May not contain `;` or `,`.                                                                                                                                                    |\n| `reply_to`                          | `object`   | no       |                                                                   |                                                                                                                                                                                                               |\n| `reply_to.email`                    | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `reply_to.name`                     | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `subject`                           | `string`   | yes *    |                                                                   | Not required if `template_id` is present and template has default subject set.                                                                                                                                |\n| `text`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in a text (`text/plain`) format. * Only required if there's no `html` or `template_id` present.                                                                                             |\n| `html`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in HTML (`text/html`) format. * Only required if there's no `text` or `template_id` present.                                                                                                |\n| `template_id`                       | `string`   | yes *    |                                                                   | * Only required if there's no `text` or `html` present.                                                                                                                                                       |\n| `tags`                              | `string[]` | no       |                                                                   | Limit is max 5 tags.                                                                                                                                                                                          |\n| `variables`                         | `object[]` | no       |                                                                   | These will be replaced in the email content using `{$var}` format. Can be used in the `subject`, `html`, `text` fields.                                                                                       |\n| `variables.*.email`                 | `string`   | yes      |                                                                   | Email address that substitutions will be applied to. Read more about [simple personalization](features.html#simple-personalization).                                                                          |\n| `variables.*.substitutions`         | `object[]` | yes      |                                                                   |                                                                                                                                                                                                               |\n| `variables.*.substitutions.*.var`   | `string`   | yes      |                                                                   | Name of the variable, will replace `{$var}` in the `subject`, `html`, `text` fields.                                                                                                                          |\n| `variables.*.substitutions.*.value` | `string`   | yes      |                                                                   | Value to be replaced, based on the `variables.*.substitutions.*.var`  name.                                                                                                                                   |\n| `personalization`                   | `object[]` | no       |                                                                   | Allows using personalization in <code v-pre>{{ var }}</code> syntax. Can be used in the `subject`, `html`, `text` fields. Read more about [advanced personalization](features.html#advanced-personalization). |\n| `personalization.*.email`           | `string`   | yes      |                                                                   | Email address that personalization will be applied to.                                                                                                                                                        |\n| `personalization.*.data`            | `object[]` | yes      |                                                                   | Object with `key: value` pairs. Values will be added to your template using <code v-pre>{{ key }}</code> syntax.                                                                                              |\n| `send_at`                           | `integer`  | no       | min: `now`, max: `now + 72hours`                                  | Has to be a [Unix timestamp](https://www.unixtimestamp.com/). **Please note that this timestamp is a minimal guarantee and that the email could be delayed due to server load.**                             |\n\n</details>\n\n### Email results\n\nAfter email sending is triggered this extension fills results into the `delivery` field.\n\n| Field      | Description                                    |\n|------------|------------------------------------------------|\n| error      | Validation error, or error from the server     |\n| message_id | Message ID in MailerSend system                |\n| state      | State of an email sending: `ERROR`, `SUCCESS`  |\n\n\n\n## 👀 Monitoring\n\nAs a best practice, you can [monitor the activity](https://firebase.google.com/docs/extensions/manage-installed-extensions#monitor) of your installed extension, including checks on its health, usage, and logs.\n","readmeContent":"# Send emails with MailerSend\n\n**Author**: [MailerSend](https://www.mailersend.com)\n\n**Description**: MailerSend is a transactional messaging service that enables developers to work faster and smarter.\n\nAn intuitively designed interface enables anyone to contribute to transactional email and SMS, while advanced sending infrastructure and flexible payment plans let you scale your sendings.\n\nBuilt by deliverability experts, your messages always get delivered, along with dedicated IP, email verification and inbound routing for a comprehensive solution.\n\nGet started right now for free!\n\n**Details**: Use this extension to send emails that contain the information from documents added to a specified Cloud Firestore collection. Adding a document triggers this extension to send an email built from the document's fields.\n\nNote that MailerSend allows you to:\n- schedule emails\n- send bulk emails\n- add attachments up to 25MB\n- organize your sendings with tags\n- track opens, clicks, and spam reports.\n\nWe welcome [bug reports and feature requests](https://github.com/mailersend/mailersend-firebase/issues/new) as well as pull requests in this GitHub repository.\n\n##### Table of Contents  \n\n  * [🧩 Install this extension](#-install-this-extension)\n    + [Console](#console)\n    + [Firebase CLI](#firebase-cli)\n  * [💪 Use the extension](#-use-the-extension)\n    + [Send an email](#send-an-email)\n    + [Additional setup](#additional-setup)\n    + [Collection fields](#collection-fields)\n    + [Email results](#email-results)\n  * [💳 Billing](#-billing)\n  * [⚙️ Configuration](#configuration)\n    + [Configuration parameters](#configuration-parameters)\n    + [Cloud Functions](#cloud-functions)\n---\n\n## 🧩 Install this extension\n\n### Console\n\n[![Install this extension in your Firebase project](https://www.gstatic.com/mobilesdk/210513_mobilesdk/install-extension.png \"Install this extension in your Firebase project\")][install-link]\n\n[install-link]: https://console.firebase.google.com/project/_/extensions/install?ref=mailersend/mailersend-email\n\n### Firebase CLI\n\n```bash\nfirebase ext:install mailersend/mailersend-email --project=[your-project-id]\n```\n\n> Learn more about installing extensions in the Firebase Extensions documentation:\n> [console](https://firebase.google.com/docs/extensions/install-extensions?platform=console),\n> [CLI](https://firebase.google.com/docs/extensions/install-extensions?platform=cli)\n\n\n## 💪 Use the extension\n\nAfter its installation, this extension monitors all document writes to the `EMAIL_COLLECTION` collection. Email is sent based on the contents of the document's fields. The document's fields specify an email data.\n\n### Send an email\n<details>\n<summary>Here's a basic example document write that would trigger this extension</summary>\n\n```js\nadmin.firestore().collection('emails').add({\n  to: [\n    {\n      email: 'recipient@example.com',\n      name: 'Recipient name'\n    }\n  ],\n  from: {\n    email: 'from@example.com',\n    name: 'From name'\n  },\n  cc: [\n    {\n      email: 'cc.recipient@example.com',\n      name: 'CC recipient name'\n    }\n  ],\n  bcc: [\n    {\n      email: 'bcc.recipient@example.com',\n      name: 'Bcc recipient name'\n    }\n  ],\n  subject: 'Hello from Firebase!',\n  html: 'This is an <code>HTML</code> email body.',\n  text: 'This is an TEXT email body.',\n  template_id: 'abc123ced',\n    variables: [\n      {\n        email: 'recipient@example.com',\n        substitutions: [\n          {\n            var: 'variable_name',\n            value: 'variable value'\n          }\n        ]\n      }\n    ],\n    personalization: [\n      {\n        email: 'recipient@example.com',\n        data: {\n          personalization_name: 'personalization value'\n        }\n      }\n    ],\n    tags: ['tag1', 'tag2'],\n    reply_to: {\n      email: 'reply_to@example.com',\n        name: 'Reply to name'\n    },\n    send_at: '123465789'\n})\n```\n\n</details>\n\n### Additional setup\n\nBefore installing this extension, set up the following Firebase service in your Firebase project:\n\n- [Cloud Firestore](https://firebase.google.com/docs/firestore/quickstart) collection in your Firebase project.\n\nThen, in the MailerSend dashboard:\n\n- Add a [domain](https://app.mailersend.com/domains) and verify it editing your DNS records.\n- Create a new [API token](https://app.mailersend.com/api-tokens) with full access.\n\n\n\n### Collection fields\n\n<details>\n<summary>Find all the JSON field parameters you can add to your API call, provided in dot notation </summary>\n<br>\n\n| JSON field parameter                | Type       | Required | Limitations                                                       | Details                                                                                                                                                                                                       |\n|-------------------------------------|------------|----------|-------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| `from`                              | `object`   | yes *    |                                                                   | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.email`                        | `string`   | yes *    | Must be a verified domain or subdomain. | Not required if set in extension config or `template_id` is present and template has default sender set.                                                                                                      |\n| `from.name`                         | `string`   | no       |                                                                   | `from.email` will be used if not provided or, if set in extension config or `template_id` is present with default values, the default subject from that will be used.                                         |\n| `to`                                | `object[]` | yes      | Min `1`, max `50`                                                 |                                                                                                                                                                                                               |\n| `to.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `to.*.name`                         | `string`   | no       |                                                                   | The name of the recipient. May not contain `;` or `,`.                                                                                                                                                        |\n| `cc`                                | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `cc.*.email`                        | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `cc.*.name`                         | `string`   | no       |                                                                   | The name of the CC recipient. May not contain `;` or `,`.                                                                                                                                                     |\n| `bcc`                               | `object[]` | no       | Max 10                                                            |                                                                                                                                                                                                               |\n| `bcc.*.email`                       | `string`   | yes      |                                                                   |                                                                                                                                                                                                               |\n| `bcc.*.name`                        | `string`   | no       |                                                                   | The name of the BCC recipient. May not contain `;` or `,`.                                                                                                                                                    |\n| `reply_to`                          | `object`   | no       |                                                                   |                                                                                                                                                                                                               |\n| `reply_to.email`                    | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `reply_to.name`                     | `string`   | no       |                                                                   | Can be set in extension config                                                                                                                                                                                |\n| `subject`                           | `string`   | yes *    |                                                                   | Not required if `template_id` is present and template has default subject set.                                                                                                                                |\n| `text`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in a text (`text/plain`) format. * Only required if there's no `html` or `template_id` present.                                                                                             |\n| `html`                              | `string`   | yes *    | Max size of 2 MB.                                                 | Email represented in HTML (`text/html`) format. * Only required if there's no `text` or `template_id` present.                                                                                                |\n| `template_id`                       | `string`   | yes *    |                                                                   | * Only required if there's no `text` or `html` present.                                                                                                                                                       |\n| `tags`                              | `string[]` | no       |                                                                   | Limit is max 5 tags.                                                                                                                                                                                          |\n| `variables`                         | `object[]` | no       |                                                                   | These will be replaced in the email content using `{$var}` format. Can be used in the `subject`, `html`, `text` fields.                                                                                       |\n| `variables.*.email`                 | `string`   | yes      |                                                                   | Email address that substitutions will be applied to. Read more about [simple personalization](features.html#simple-personalization).                                                                          |\n| `variables.*.substitutions`         | `object[]` | yes      |                                                                   |                                                                                                                                                                                                               |\n| `variables.*.substitutions.*.var`   | `string`   | yes      |                                                                   | Name of the variable, will replace `{$var}` in the `subject`, `html`, `text` fields.                                                                                                                          |\n| `variables.*.substitutions.*.value` | `string`   | yes      |                                                                   | Value to be replaced, based on the `variables.*.substitutions.*.var`  name.                                                                                                                                   |\n| `personalization`                   | `object[]` | no       |                                                                   | Allows using personalization in <code v-pre>{{ var }}</code> syntax. Can be used in the `subject`, `html`, `text` fields. Read more about [advanced personalization](features.html#advanced-personalization). |\n| `personalization.*.email`           | `string`   | yes      |                                                                   | Email address that personalization will be applied to.                                                                                                                                                        |\n| `personalization.*.data`            | `object[]` | yes      |                                                                   | Object with `key: value` pairs. Values will be added to your template using <code v-pre>{{ key }}</code> syntax.                                                                                              |\n| `send_at`                           | `integer`  | no       | min: `now`, max: `now + 72hours`                                  | Has to be a [Unix timestamp](https://www.unixtimestamp.com/). **Please note that this timestamp is a minimal guarantee and that the email could be delayed due to server load.**                             |\n\n</details>\n\n### Email results\n\nAfter email sending is triggered this extension fills results into the `delivery` field.\n\n| Field      | Description                                    |\n|------------|------------------------------------------------|\n| error      | Validation error, or error from the server     |\n| message_id | Message ID in MailerSend system                |\n| state      | State of an email sending: `ERROR`, `SUCCESS`  |\n\n\n<!-- We recommend keeping the following section to explain how billing for Firebase Extensions works -->\n## 💳 Billing\n\nThis extension uses other Firebase or Google Cloud Platform services which may have associated charges:\n\n<!-- List all products the extension interacts with -->\n- Cloud Functions\n\nWhen you use Firebase Extensions, you're only charged for the underlying resources that you use. A paid-tier billing plan is only required if the extension uses a service that requires a paid-tier plan, for example calling to a Google Cloud Platform API or making outbound network requests to non-Google services. All Firebase services offer a free tier of usage. [Learn more about Firebase billing.](https://firebase.google.com/pricing)\n\nThis extension also uses the following third-party services:\n\n- MailerSend ([pricing information](https://mailersend.com/pricing))\n\nYou are responsible for any costs associated with your use of these services.\n\n## ⚙️Configuration\n\n### Configuration Parameters\n\n* Cloud Functions location: Where do you want to deploy the functions created for this extension? For help selecting a location, refer to the [location selection guide](https://firebase.google.com/docs/functions/locations).\n\n* Emails documents collection: What is the path to the collection that contains the documents used to build and send the email?\n\n* MailerSend API key: API tokens are used for authentication when sending emails. You can find more details how to create an API token [here](https://www.mailersend.com/help/managing-api-tokens).\n* Email parameters:\n\n    + Default FROM email address: The email address to use as the sender's address (if it's not specified in the added email document or template).\n\n    + Default FROM name: The name to use as the sender's name.\n\n    + Default reply to email address: The email address to use as the reply to address (if it's not specified in the added email document or template).(not required)\n\n    + Default reply to name: The name to use as the reply to name. (not required)\n\n    + Default template ID: The default template id to use for emails (it will be used if not specified in the added email document).\n\n\n\n### Cloud Functions\n\n* processDocumentCreated: Processes created document in Cloud Firestore collection, sends an email and updates status information.\n","displayName":"Send email with MailerSend","systemParams":[{"param":"firebaseextensions.v1beta.function/memory","label":"Function memory","type":"SELECT","description":"How much memory should be allocated to each function?","options":[{"value":"128","label":"128MB"},{"value":"256","label":"256MB"},{"value":"512","label":"512MB"},{"value":"1024","label":"1GB"},{"value":"2048","label":"2GB"},{"value":"4096","label":"4GB"},{"value":"8192","label":"8GB"}],"default":"256","advanced":true},{"param":"firebaseextensions.v1beta.function/timeoutSeconds","label":"Function timeout seconds","type":"STRING","description":"How long should functions run before timing out, in seconds (0-540)?","validationRegex":"^[1-9][0-9]{0,2}$","validationErrorMessage":"Function timeout should be an integer number of seconds, between 0 and 540","advanced":true},{"param":"firebaseextensions.v1beta.function/vpcConnector","label":"VPC Connector","type":"STRING","description":"The VPC Network Connector that this cloud function can connect to. It can be either the fully-qualified URI, or the short name of the network connector resource. The format of this field is projects/*/locations/*/connectors/*.","validationRegex":"^projects/([^/]+)/locations/([^/]+)/connectors/([^/]+)$","advanced":true},{"param":"firebaseextensions.v1beta.function/vpcConnectorEgressSettings","label":"VPC Connector Egress settings","type":"SELECT","description":"Controls outgoing traffic when a VPC connector is configured","options":[{"value":"VPC_CONNECTOR_EGRESS_SETTINGS_UNSPECIFIED","label":"Unspecified"},{"value":"PRIVATE_RANGES_ONLY","label":"Private ranges only"},{"value":"ALL_TRAFFIC","label":"All traffic"}],"default":"VPC_CONNECTOR_EGRESS_SETTINGS_UNSPECIFIED","advanced":true},{"param":"firebaseextensions.v1beta.function/minInstances","label":"Minimum function instances","type":"STRING","description":"The minimum number of instances of each function to run at once (0-1000)","default":"0","validationRegex":"^[0-9]*$","validationErrorMessage":"Min instances must be a non-negative integer.","advanced":true},{"param":"firebaseextensions.v1beta.function/maxInstances","label":"Maximum function instances","type":"STRING","description":"The maximum number of instances of each function to run at once","default":"3000","validationRegex":"^[0-9]*$","validationErrorMessage":"Max instances must be a non-negative integer.","advanced":true},{"param":"firebaseextensions.v1beta.function/ingressSettings","label":"Function ingress settings","type":"SELECT","description":"Where should functions allow incoming traffic from?","options":[{"value":"ALLOW_ALL","label":"Allow all"},{"value":"ALLOW_INTERNAL_ONLY","label":"Allow internal only"},{"value":"ALLOW_INTERNAL_AND_GCLB","label":"Allow internal and GCLB"}],"advanced":true},{"param":"firebaseextensions.v1beta.function/labels","label":"Function labels","type":"STRING","description":"Do you wish to set any labels on this instance's Cloud Functions? If so, provide up to 55 labels in the format 'key1:value, key2:value'","validationRegex":"^([a-zžà-ÿ][A-Za-zŽžÀ-ÿ0-9_-]{0,62}:[A-Za-zŽžÀ-ÿ0-9_-]{0,63},\\s*)*([a-zžà-ÿ][A-Za-zŽžÀ-ÿ0-9_-]{0,62}:[A-Za-zŽžÀ-ÿ0-9_-]{0,63})$","advanced":true}],"icon":"mailersend.png"},"state":"PUBLISHED","hash":"349415ed91d0080ddbbe24bf03801994a5281fdbb5531513cf0a541be3c81bde","createTime":"2023-04-26T08:27:30.954052Z","sourceDownloadUri":"https://storage.googleapis.com/firebase-mod-sources-prod/349415ed91d0080ddbbe24bf03801994a5281fdbb5531513cf0a541be3c81bde","id":"0.1.4","releaseNotes":"- Add extension tags\n","icons":[{"iconUri":"https://storage.googleapis.com/firebase-extensions-icons/extension_icons/mailersend/mailersend-email_0.1.4@512.png","iconType":"PNG_512"}]}
[info] Downloading and validating source code...
[error] 
[error] Error: The version you are trying to publish (0.1.4) already exists for Extension 'mailersend/mailersend-email'. Please increment the version inside of extension.yaml.

